<!DOCTYPE html>
<html lang="hi">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Breaking News â€” Live Broadcast</title>
<style>
*{margin:0;padding:0;box-sizing:border-box}
body{font-family:'Segoe UI',sans-serif;background:#000;color:#fff;height:100vh;overflow:hidden;display:flex;flex-direction:column}

/* â”€â”€ TOP BAR â”€â”€ */
.top-bar{
  background:linear-gradient(90deg,#1a0000,#0d0d0d);
  border-bottom:2px solid #e63946;
  padding:8px 18px;
  display:flex;align-items:center;gap:14px;
  flex-shrink:0;z-index:10;
}
.brk-label{
  background:#e63946;color:#fff;
  font-weight:900;font-size:11px;
  padding:4px 12px;border-radius:3px;
  letter-spacing:2px;flex-shrink:0;
}
.channel-name{
  font-size:15px;font-weight:800;
  color:#fff;letter-spacing:1px;
  flex-shrink:0;
}
.spacer{flex:1}
.time-display{
  font-size:13px;font-weight:700;
  color:#ccc;font-family:monospace;
  flex-shrink:0;
}
.live-pill{
  display:flex;align-items:center;gap:6px;
  background:#e63946;
  padding:4px 12px;border-radius:20px;
  font-size:11px;font-weight:800;
  letter-spacing:1px;flex-shrink:0;
}
.ldot{width:7px;height:7px;border-radius:50%;background:#fff;animation:ld 1s infinite}
@keyframes ld{0%,100%{opacity:1}50%{opacity:0}}

/* â”€â”€ VIDEO AREA â”€â”€ */
.video-wrap{flex:1;position:relative;background:#000;overflow:hidden}
#vid{width:100%;height:100%;object-fit:contain;display:block}

/* subtle vignette only â€” no heavy overlay */
.vignette{
  position:absolute;inset:0;
  background:
    linear-gradient(to top, rgba(0,0,0,0.6) 0%, transparent 25%),
    linear-gradient(to bottom, rgba(0,0,0,0.3) 0%, transparent 20%);
  pointer-events:none;
}

/* â”€â”€ WATERMARK â”€â”€ */
.watermark{
  position:absolute;top:12px;left:50%;
  transform:translateX(-50%);
  background:rgba(230,57,70,.1);
  border:1px solid rgba(230,57,70,.2);
  color:rgba(255,255,255,.35);
  padding:3px 14px;border-radius:3px;
  font-size:10px;font-weight:800;letter-spacing:3px;
  pointer-events:none;
}

/* â”€â”€ NEWS COUNTER â”€â”€ */
.n-indicator{
  position:absolute;top:12px;right:14px;
  background:rgba(0,0,0,.7);
  border:1px solid rgba(230,57,70,.5);
  padding:5px 14px;border-radius:20px;
  font-size:12px;font-weight:700;
  color:#fff;
}

/* â”€â”€ VIDEO COUNTER â”€â”€ */
.vc-indicator{
  position:absolute;top:12px;left:14px;
  background:rgba(0,0,0,.65);
  border:1px solid rgba(255,255,255,.1);
  padding:5px 14px;border-radius:20px;
  font-size:11px;color:#aaa;display:none;
}

/* â”€â”€ TTS PILL â”€â”€ */
.tts-pill{
  position:absolute;top:52px;right:14px;
  background:rgba(230,57,70,.15);
  border:1px solid rgba(230,57,70,.4);
  border-radius:20px;padding:5px 14px;
  font-size:11px;color:#ff8888;
  display:none;align-items:center;gap:7px;
}
.tts-wave{display:flex;gap:2px;align-items:center;height:12px}
.tw{width:3px;background:#e63946;border-radius:3px;animation:wv .7s infinite}
.tw:nth-child(2){animation-delay:.15s}
.tw:nth-child(3){animation-delay:.3s}
@keyframes wv{0%,100%{height:3px}50%{height:12px}}

/* â”€â”€ LOOP INDICATOR â”€â”€ */
.loop-pill{
  position:absolute;top:52px;left:14px;
  background:rgba(0,0,0,.65);
  border:1px solid rgba(255,255,255,.1);
  padding:5px 14px;border-radius:20px;
  font-size:11px;color:#666;
}

/* â”€â”€ CONTROLS BAR â”€â”€ */
.ctrl-bar{
  position:absolute;bottom:54px;
  left:0;right:0;
  padding:0 20px;
  display:flex;align-items:center;
  justify-content:space-between;gap:12px;
}

.ctrl-group{display:flex;align-items:center;gap:8px}

.cbtn{
  background:rgba(20,20,40,.85);
  border:1px solid rgba(255,255,255,.15);
  color:#fff;padding:9px 18px;
  border-radius:8px;cursor:pointer;
  font-size:13px;font-weight:700;
  transition:all .2s;
  backdrop-filter:blur(8px);
  white-space:nowrap;
}
.cbtn:hover{background:rgba(60,60,100,.9);border-color:rgba(255,255,255,.3)}
.cbtn:disabled{opacity:.2;cursor:not-allowed}

.cbtn.red{
  background:rgba(200,30,40,.85);
  border-color:#e63946;padding:9px 28px;
}
.cbtn.red:hover{background:rgba(230,57,70,1)}

.cbtn.active{
  background:rgba(230,57,70,.3);
  border-color:#e63946;color:#ff8888;
}

.icon-btn{
  background:rgba(20,20,40,.85);
  border:1px solid rgba(255,255,255,.15);
  color:#fff;width:40px;height:40px;
  border-radius:8px;cursor:pointer;
  font-size:18px;transition:all .2s;
  display:flex;align-items:center;justify-content:center;
  backdrop-filter:blur(8px);
}
.icon-btn:hover{background:rgba(60,60,100,.9)}
.icon-btn.active{background:rgba(230,57,70,.3);border-color:#e63946}

/* â”€â”€ TICKER BOTTOM â”€â”€ */
.ticker-bar{
  background:linear-gradient(90deg,#cc0000,#e63946);
  padding:0;
  display:flex;align-items:stretch;
  flex-shrink:0;height:38px;
  overflow:hidden;position:relative;
  z-index:10;
}
.ticker-label{
  background:#fff;color:#cc0000;
  font-weight:900;font-size:11px;
  padding:0 16px;letter-spacing:2px;
  display:flex;align-items:center;
  flex-shrink:0;white-space:nowrap;
  z-index:2;
}
.ticker-track{
  flex:1;overflow:hidden;
  display:flex;align-items:center;
  position:relative;
}
.ticker-content{
  display:inline-block;
  white-space:nowrap;
  font-size:14px;font-weight:600;
  color:#fff;letter-spacing:.3px;
  animation:tickerScroll 20s linear infinite;
  padding-left:100%;
}
@keyframes tickerScroll{
  0%{transform:translateX(0)}
  100%{transform:translateX(-100%)}
}

/* â”€â”€ NO NEWS â”€â”€ */
.no-news{
  position:absolute;inset:0;
  display:flex;flex-direction:column;
  align-items:center;justify-content:center;
  background:#050512;z-index:5;
}
.no-news .ni{font-size:60px;margin-bottom:14px}
.no-news h2{font-size:18px;color:#444;margin-bottom:6px}
.no-news p{font-size:13px;color:#333}
.no-news a{color:#e63946;text-decoration:none;font-weight:700}

/* â”€â”€ START OVERLAY â”€â”€ */
.start-overlay{
  position:absolute;inset:0;
  background:rgba(0,0,0,.9);
  display:flex;flex-direction:column;
  align-items:center;justify-content:center;
  z-index:20;backdrop-filter:blur(8px);
  cursor:pointer;
}
.so-logo{
  background:#e63946;color:#fff;
  font-weight:900;font-size:13px;
  padding:6px 20px;border-radius:4px;
  letter-spacing:3px;margin-bottom:28px;
}
.start-overlay h2{font-size:28px;font-weight:800;margin-bottom:10px}
.start-overlay p{font-size:14px;color:#666;margin-bottom:40px}
.start-btn{
  background:linear-gradient(135deg,#e63946,#c62828);
  color:#fff;border:none;
  padding:18px 56px;border-radius:50px;
  font-size:20px;font-weight:800;
  cursor:pointer;letter-spacing:1px;
  box-shadow:0 8px 40px rgba(230,57,70,.5);
  animation:pulse 2s infinite;
}
@keyframes pulse{0%,100%{box-shadow:0 8px 32px rgba(230,57,70,.4)}50%{box-shadow:0 8px 56px rgba(230,57,70,.8)}}
.start-btn:hover{transform:scale(1.04)}
.so-hint{margin-top:18px;font-size:12px;color:#333}
</style>
</head>
<body>

<!-- TOP BAR -->
<div class="top-bar">
  <div class="brk-label">BREAKING</div>
  <div class="channel-name">NEWS LIVE</div>
  <div class="spacer"></div>
  <div class="time-display" id="clockDisplay">00:00:00</div>
  <div class="live-pill"><div class="ldot"></div>LIVE</div>
</div>

<!-- VIDEO AREA -->
<div class="video-wrap">
  <video id="vid" playsinline></video>
  <div class="vignette"></div>
  <div class="watermark">BREAKING NEWS</div>
  <div class="n-indicator" id="nInd">â€” / â€”</div>
  <div class="vc-indicator" id="vcInd">VIDEO 1/1</div>
  <div class="tts-pill" id="ttsPill">
    <div class="tts-wave"><div class="tw"></div><div class="tw"></div><div class="tw"></div></div>
    <span id="ttsLbl">TTS Playing...</span>
  </div>
  <div class="loop-pill" id="loopPill">ğŸ” Loop: ON</div>

  <!-- No News -->
  <div class="no-news" id="noNews" style="display:none">
    <div class="ni">ğŸ“º</div>
    <h2>Koi News Nahi Mili</h2>
    <p><a href="admin.html">Admin Panel</a> mein news add karein</p>
  </div>

  <!-- START OVERLAY -->
  <div class="start-overlay" id="startOverlay" onclick="startBroadcast()">
    <div class="so-logo">BREAKING NEWS</div>
    <h2>ğŸ“º Live Broadcast</h2>
    <p>Broadcast shuru karne ke liye click karein</p>
    <button class="start-btn">â–¶ START BROADCAST</button>
    <div class="so-hint">Screen par kahin bhi click karein</div>
  </div>

  <!-- CONTROLS BAR -->
  <div class="ctrl-bar">
    <!-- Left: Prev -->
    <div class="ctrl-group">
      <button class="cbtn" id="prevBtn" onclick="prevNews()" disabled>â—€ PREV</button>
    </div>

    <!-- Center: Audio Controls -->
    <div class="ctrl-group">
      <!-- TTS Button -->
      <button class="icon-btn" id="ttsBtn" onclick="toggleTTS()" title="TTS On/Off">ğŸ”Š</button>
      <span style="font-size:11px;color:#555;font-weight:700;">TTS</span>

      <div style="width:1px;height:28px;background:#222;margin:0 6px"></div>

      <!-- Video Mute Button -->
      <button class="icon-btn" id="vidMuteBtn" onclick="toggleVidMute()" title="Video Audio">ğŸ¬</button>
      <span style="font-size:11px;color:#555;font-weight:700;">VID</span>

      <div style="width:1px;height:28px;background:#222;margin:0 6px"></div>

      <!-- Loop Button -->
      <button class="icon-btn active" id="loopBtn" onclick="toggleLoop()" title="Loop Videos">ğŸ”</button>
      <span style="font-size:11px;color:#555;font-weight:700;">LOOP</span>

      <div style="width:1px;height:28px;background:#222;margin:0 6px"></div>

      <!-- Replay TTS -->
      <button class="cbtn" onclick="replayTTS()" title="TTS Dobara Chalao">â†º TTS</button>
    </div>

    <!-- Right: Next -->
    <div class="ctrl-group">
      <button class="cbtn red" id="nextBtn" onclick="nextNews()">NEXT â–¶</button>
    </div>
  </div>
</div>

<!-- TICKER BAR (BOTTOM) -->
<div class="ticker-bar">
  <div class="ticker-label">âš¡ BREAKING</div>
  <div class="ticker-track">
    <div class="ticker-content" id="tickerContent">Loading news...</div>
  </div>
</div>

<script>
// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
//  STATE
// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
let items       = [];
let cur         = 0;   // current news index
let vcur        = 0;   // current video index
let vidMuted    = true;  // video audio â€” default mute (TTS ke saath conflict na ho)
let ttsEnabled  = true;  // TTS on/off
let loopEnabled = true;  // video loop
let ttsPlayed   = false;
let broadcastStarted = false;
let synth       = window.speechSynthesis;
let currentUtterance = null;

// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
//  INIT
// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
window.onload = () => {
  loadNews();
  setInterval(loadNews, 30000);
  startClock();
  updateAllButtons();
};

function startClock(){
  function tick(){
    const now = new Date();
    document.getElementById('clockDisplay').textContent =
      now.toLocaleTimeString('en-IN',{hour:'2-digit',minute:'2-digit',second:'2-digit'});
  }
  tick(); setInterval(tick, 1000);
}

// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
//  LOAD NEWS
// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
function loadNews(){
  const s = localStorage.getItem('bn_news');
  if(s){
    const d = JSON.parse(s);
    if(d.length){
      const wasEmpty = !items.length;
      items = d;
      document.getElementById('noNews').style.display = 'none';
      if(cur >= items.length) cur = 0;
      if(wasEmpty && broadcastStarted) renderCurrent();
      else if(!broadcastStarted) updateTickerOnly();
      updateNav();
    } else {
      document.getElementById('noNews').style.display = 'flex';
    }
  } else {
    document.getElementById('noNews').style.display = 'flex';
  }
}

function updateTickerOnly(){
  if(!items.length) return;
  // Ticker mein saari news ek saath
  const allText = items.map((it,i) => `â— NEWS ${i+1}: ${it.text}`).join('      ');
  const el = document.getElementById('tickerContent');
  el.textContent = allText;
  // Speed adjust based on length
  const duration = Math.max(15, allText.length * 0.09);
  el.style.animationDuration = duration + 's';
}

// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
//  START BROADCAST
// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
function startBroadcast(){
  if(broadcastStarted) return;
  broadcastStarted = true;
  document.getElementById('startOverlay').style.display = 'none';
  if(!items.length){
    document.getElementById('noNews').style.display = 'flex';
    return;
  }
  renderCurrent();
}

// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
//  RENDER CURRENT NEWS
// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
function renderCurrent(){
  if(!items.length) return;
  const it = items[cur];
  vcur = 0;
  ttsPlayed = false;

  // Indicators
  document.getElementById('nInd').textContent = `NEWS ${cur+1} / ${items.length}`;
  updateNav();

  // Video counter
  const vcEl = document.getElementById('vcInd');
  if(it.videos.length > 1){
    vcEl.style.display = 'block';
    vcEl.textContent = `VIDEO 1 / ${it.videos.length}`;
  } else {
    vcEl.style.display = 'none';
  }

  // Ticker â€” current news BOLD style (sirf current news ticker mein)
  updateTicker();

  // Load video
  loadVid(it.videos[0].url);

  // TTS
  if(ttsEnabled) playTTS(it.text);
}

function updateTicker(){
  if(!items.length) return;
  // Saari news ticker mein, current news highlighted
  const parts = items.map((it,i) => {
    if(i === cur) return `â–¶ ${it.text}`;
    return `â— ${it.text}`;
  });
  const allText = parts.join('          ');
  const el = document.getElementById('tickerContent');
  el.textContent = allText;
  const duration = Math.max(15, allText.length * 0.085);
  el.style.animationDuration = duration + 's';
  // Restart animation
  el.style.animation = 'none';
  el.offsetHeight; // reflow
  el.style.animation = `tickerScroll ${duration}s linear infinite`;
}

// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
//  VIDEO PLAYER
// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
function loadVid(url){
  const v = document.getElementById('vid');
  v.src = url;
  v.muted = vidMuted;
  v.load();

  v.oncanplay = () => {
    v.play().catch(err => {
      // Fallback â€” muted play
      v.muted = true;
      v.play().catch(()=>{});
    });
  };

  v.onended = () => {
    const it = items[cur];
    const nextV = vcur + 1;

    if(nextV < it.videos.length){
      // Agli video is news ki
      vcur = nextV;
      document.getElementById('vcInd').textContent = `VIDEO ${vcur+1} / ${it.videos.length}`;
      loadVid(it.videos[vcur].url);
    } else if(loopEnabled){
      // Loop â€” wapas pehli video
      vcur = 0;
      if(it.videos.length > 1)
        document.getElementById('vcInd').textContent = `VIDEO 1 / ${it.videos.length}`;
      loadVid(it.videos[0].url);
    }
    // Loop off hai toh ruk jao â€” user manually next karega
  };

  v.onerror = () => console.error('Video load error:', url);
}

// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
//  AUDIO CONTROLS
// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

// Video audio toggle
function toggleVidMute(){
  vidMuted = !vidMuted;
  document.getElementById('vid').muted = vidMuted;
  updateAllButtons();
}

// TTS on/off toggle
function toggleTTS(){
  ttsEnabled = !ttsEnabled;
  if(!ttsEnabled) stopTTS();
  updateAllButtons();
}

// Loop toggle
function toggleLoop(){
  loopEnabled = !loopEnabled;
  document.getElementById('loopPill').textContent = loopEnabled ? 'ğŸ” Loop: ON' : 'â¹ Loop: OFF';
  document.getElementById('loopPill').style.color = loopEnabled ? '#666' : '#e63946';
  updateAllButtons();
}

// TTS dobara chalao manually
function replayTTS(){
  if(!items.length) return;
  ttsPlayed = false;
  playTTS(items[cur].text);
}

function updateAllButtons(){
  // Video mute button
  const vmb = document.getElementById('vidMuteBtn');
  vmb.textContent = vidMuted ? 'ğŸ”‡' : 'ğŸ¬';
  vmb.classList.toggle('active', !vidMuted);
  vmb.title = vidMuted ? 'Video Audio: OFF (Click to ON)' : 'Video Audio: ON (Click to OFF)';

  // TTS button
  const tb = document.getElementById('ttsBtn');
  tb.textContent = ttsEnabled ? 'ğŸ”Š' : 'ğŸ”•';
  tb.classList.toggle('active', ttsEnabled);
  tb.title = ttsEnabled ? 'TTS: ON (Click to OFF)' : 'TTS: OFF (Click to ON)';

  // Loop button
  const lb = document.getElementById('loopBtn');
  lb.textContent = loopEnabled ? 'ğŸ”' : 'â¹';
  lb.classList.toggle('active', loopEnabled);
}

// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
//  NAVIGATION
// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
function nextNews(){
  if(cur < items.length - 1){
    cur++;
    stopTTS();
    renderCurrent();
  }
}

function prevNews(){
  if(cur > 0){
    cur--;
    stopTTS();
    renderCurrent();
  }
}

function updateNav(){
  document.getElementById('prevBtn').disabled = cur === 0;
  const nb = document.getElementById('nextBtn');
  nb.textContent = cur < items.length - 1 ? 'NEXT â–¶' : 'END â– ';
  nb.disabled = cur >= items.length - 1;
}

// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
//  TTS
// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
function detectLang(t){
  return /[\u0900-\u097F]/.test(t) ? 'hi-IN' : 'en-US';
}

function playTTS(text){
  if(!synth || !ttsEnabled) return;
  stopTTS();

  setTimeout(()=>{
    const u = new SpeechSynthesisUtterance(text);
    u.lang    = detectLang(text);
    u.rate    = 0.88;
    u.pitch   = 1;
    u.volume  = 1;

    // Best voice select karo
    const voices = synth.getVoices();
    const match  = voices.find(v => v.lang === u.lang)
                || voices.find(v => v.lang.startsWith(u.lang.split('-')[0]));
    if(match) u.voice = match;

    u.onstart = () => {
      ttsPlayed = true;
      const p = document.getElementById('ttsPill');
      p.style.display = 'flex';
      document.getElementById('ttsLbl').textContent =
        u.lang === 'hi-IN' ? 'Hindi TTS...' : 'English TTS...';
    };

    u.onend = u.onerror = () => {
      document.getElementById('ttsPill').style.display = 'none';
    };

    currentUtterance = u;
    synth.speak(u);
    ttsPlayed = true;
  }, 600);
}

function stopTTS(){
  if(synth && synth.speaking) synth.cancel();
  currentUtterance = null;
  document.getElementById('ttsPill').style.display = 'none';
}

if(synth) synth.onvoiceschanged = () => {};
</script>
</body>
</html>
